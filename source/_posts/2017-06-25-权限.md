---
title: 使用权限
tags:
  - android
  - 权限
date: 2017-06-25 15:37:22
categories: 笔记
---

[系统权限](https://developer.android.com/guide/topics/security/permissions.html)

> ​	Android 是一个权限分隔的操作系统，其中每个应用都有其独特的系统标识（Linux 用户 ID 和组 ID）。系统各部分也分隔为不同的标识。Linux 据此将不同的应用以及应用与系统分隔开来。

### 权限使用

​	基本 Android 应用默认情况下未关联权限，如果需要添加权限，则需要在 AndroidManifest.xml 中使用\<uses-permission\>  添加。如：

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.android.app.myapp" >
    <uses-permission android:name="android.permission.RECEIVE_SMS" />
    ...
</manifest>
```

​	如果是普通的权限(即不会对用户隐私或设备操作造成很大风险的权限)，系统会自动授予这些权限；如果时危险的权限(即可能影响用户隐私或设备正常操作的权限)，系统会要求用户明确授予这些权限。Android 发出请求的方式取决于系统版本：

+ 设备 Android 6.0 +，且应用的 targetSdkVersion 为23+，则应用会在运行时向用户请求权限。用户可随时调用权限，因此应用在每次运行时均需检查自身是否具备所需的权限。
+ 设备 Android 5.0 或更低，且 targetSdkVersion 为22或更低，则系统会在用户安装应用时要求用户授予权限。如果将新权限添加到更新的应用版本，系统会在用户更新应用时要求授予该权限。用户一旦安装应用，他们撤销权限的唯一方式是卸载应用。



### 正常权限和危险权限

+ [正常权限](https://developer.android.com/guide/topics/security/normal-permissions.html)涵盖应用需要访问其沙盒外部数据或资源，但对用户隐私或其他应用操作风险很小的区域。
+ 危险权限涵盖应用需要涉及用户隐私信息的数据或资源，或者可能对用户存储的数据或其他应用的操作产生影响的区域。




### 权限组

[危险权限和权限组](https://developer.android.com/guide/topics/security/permissions.html#perm-groups)

​	所有危险的 Android 系统权限都属于权限组。

​	设备 6.0 + ，且应用的 targetSdkVersion 为 23 以上，当用户请求危险权限时，将发生：

+ 如果应用请求其清单中列出的危险权限，而应用目前在权限组中没有任何权限，则系统会向用户显示一个对话框，**描述应用要访问的权限组**。对话框**不描述该组内的具体权限**。
+ 如果应用请求其清单中列出的危险权限，而应用在同一权限组中已有另一项危险权限，则系统会立即授予该权限，而无需与用户进行任何交互。

### 定义和实施权限

​	要实施自己的权限，必须现在 AndroidMainfest 中使用\<permission> 进行声明。如：

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.myapp" >
    <permission android:name="com.example.myapp.permission.DEADLY_ACTIVITY"
        android:label="@string/permlab_deadlyActivity"
        android:description="@string/permdesc_deadlyActivity"
        android:permissionGroup="android.permission-group.COST_MONEY"
        android:protectionLevel="dangerous" />
    ...
</manifest>
```

> 系统不允许多个软件包使用同一名称声明权限，除非所有软件包都使用同一证书签署。

​	使用 `adb shell pm list permissions`  可以查看系统中当前定义的权限。