---
title: Scroll概念
tags:
  - android
date: 2017-03-11 15:37:22
categories: 笔记
---

[Animating a Scroll Gesture](https://developer.android.com/training/gestures/scroll.html#term)

[Viewport wiki](https://en.wikipedia.org/wiki/Viewport)

[Android View移动的3种方式总结](http://www.jb51.net/article/92788.htm)

## Scrolling术语解释

​	根据内容（context）的不同，Android中的“Scrolling”会有不同的含义。

​	**Scrolling是移动viewport（我们所看到的内容的“窗口”）一般过程。**但同时在x和y方向进行scrolling时，也叫做padding（镜头移动）。

​	Scrolling有两种不同类型：

+ dragging

  用户用手指在触摸屏上拖动。简单的dragging通常通过重写GestureDetector.OnGestureListener中的onScroll()来实现；

+ flinging

  用户拖动然后快速举起手指，用户举起手指后，会保持scroll（viewport移动）并减速知道viewport停止移动。fling可以通过重写 GestureDetector.OnGestureListener中的onFling()来实现。




### Viewport

​	viewport在计算机图形学中表示一个可见的多边形区域（通常为矩形）。

> ​	此处的可见并不只表示我们眼睛通过屏幕所能看到的区域，还包括了屏幕外的区域，即由于设备限制被遮挡的部分。viewport是设备要渲染的区域，而屏幕只关心其能显示的部分，通常，viewport的区域会比设备的屏幕要大。这就好像通过镜头来观看世界。



## ScrollTo和ScrollBy

​	scrollTo(x, y)的理解：以父视图建立一个坐标系，左上角为坐标原点(0, 0)，将父视图内的所有内容想象成一个巨大的子View，即viewport，viewport的范围远远大于父视图，其上面的每一个点根据父视图的坐标系都可以确定一个唯一的坐标，==**在scroll过程中，viewport上的坐标不会发生变化**==。scrollTo(x, y)就相当于将子View上的点(x, y)移动到了父视图的原点(0, 0)，其他内容做相应的移动，**多次调用scrollTo(x, y)，viewport只在第一次发生了移动**。进一步举例说明，假如A是父视图中的一个确实的子View，其左上角坐标为(x1, y1)，scrollTo(x, y)后，其左上角的坐标移动到了(y1 - x, y1 - y)的位置，但其左上角的坐标还是(x1, y1)。而**scrollBy(x, y)与当前的绝对坐标值无关，其只跟移动的偏移量有关，所以多次调用scrollBy(x, y)将不断重复相同的位移。**

​	==**viewport与其父视图的移动是相反的，所以我们通常在onTouchEvent中对需要计算出来的偏移量取相反值进行scroll。**==比如，手势滑动从(x1, y1)到(x2, y2)，此时父视图计算得到的偏移量为x2 - x1、y2 - y1，但对于viewport而言，其偏移为-(x2 - x1)、-(y2 - y1)，可以想象成将点(-(x2 - x1), -(y2 - y1))移动到了原点的位置。通过scrollTo(-(x2 - x1), -(y2 - y1))或者scrollBy(-(x2 - x1), -(y2 - y1))可以实现相同的效果，但假如手势多次滑动，**使用scrollTo进行scroll时，需要将每一次的偏移量相加（即当前scroll位置加上新的偏移量）才能得到最后正确的滑动位置，通过调用父视图的getScrollX()、getScrollY()可以获得当前滚动的位置。**

> 注意：移动viewport并不会影响子View与父视图间的相对位置，即scroll前后，使用getLeft()和getX()获得的值相同。

















