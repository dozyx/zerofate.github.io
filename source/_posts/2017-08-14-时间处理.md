---
title: 处理时间
tags:
  - android
  - 规范
date: 2017-08-14 15:37:22
categories: 笔记
---

[Time for non-Time Lords – Part 1](https://blog.stylingandroid.com/time-for-non-time-lords-part-1/)

### 时间单位

问题：

```kotlin
class MainActivity : AppCompatActivity() {
 
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
 
        text.alpha = 0f
        text.animate()
                .alpha(1f)
                .apply { duration = 1000 }
                .start()
 
    }
}
```

​	上面代码的一个问题在于，duration 的单位没有作出明确指示，这样开发者就必须通过源码或者 Javadoc 才能做出判断。

+ 方案一：在参数名上加上单位，如 durationMillis

+ 方案二：在方法中指定一个单位

  如修改为：

  ```kotlin
  fun ViewPropertyAnimator.setDuration(durationInUnits: Long, unit: TimeUnit): ViewPropertyAnimator =
          apply {
              duration = unit.toMillis(durationInUnits)
          }
  ```

  使用：

  ```kotlin
  class MainActivity : AppCompatActivity() {
      override fun onCreate(savedInstanceState: Bundle?) {
          super.onCreate(savedInstanceState)
          setContentView(R.layout.activity_main)
   
          text.alpha = 0f
          text.animate()
                  .alpha(1f)
                  .setDuration(1, TimeUnit.SECONDS)
                  .start()
      }
  }
  ```

  其中，TimeUnit 位于 Java 1.5 加入的 concurrency 包中。

+ 方案三：对于无法控制的第三方 API，可以为它们指定同一单位 API

  ```kotlin
  class MainActivity : AppCompatActivity() {

      override fun onCreate(savedInstanceState: Bundle?) {
          super.onCreate(savedInstanceState)
          setContentView(R.layout.activity_main)

          text.alpha = 0f
          text.animate()
                  .alpha(1f)
                  .apply { duration = TimeUnit.SECONDS.toMillis(1)}
                  .start()

      }
  }
  ```

  这样做的好处在于，审查代码的人将不用检查  Javadoc，同时也能帮助以后维护代码的人。