---
title: 百分比布局
tags:
  - android
date: 2017-05-21 15:37:22
categories: 笔记
---

​	LinearLayout、FrameLayout、ReleativeLayout 三个布局中，只有 LinearLayout 支持使用 layout_weight 属性来按照比例指定 View 大小，百分比布局为 FrameLayout 和 ReleativeLayout 进行了功能扩展，提供了 PercentFrameLayout 和 PercentFrameLayout。

​	百分比布局定义在支持库中，使用时需要在 gradle 中添加依赖

`compile 'com.android.support:percent:24.2.1'`

​	百分比布局支持增加了以下属性

```
<attr name="layout_widthPercent" format="fraction"/>
<attr name="layout_heightPercent" format="fraction"/>
<attr name="layout_marginPercent" format="fraction"/>
<attr name="layout_marginLeftPercent" format="fraction"/>
<attr name="layout_marginTopPercent" format="fraction"/>
<attr name="layout_marginRightPercent" format="fraction"/>
<attr name="layout_marginBottomPercent" format="fraction"/>
<attr name="layout_marginStartPercent" format="fraction"/>
<attr name="layout_marginEndPercent" format="fraction"/>
<attr name="layout_aspectRatio" format="fraction" />
```

​	其中，layout_aspectRatio 表示的是宽高比例，如：指定 layout_widthPercent 为50%，layout_aspectRatio 为150%，则高为50% / 150%；指定 layout_heightPercent 为50%，则宽为 50% * 150 %。layout_aspectRatio 也可以配合 layout_width/height 使用。

​	在官方文档里有这么一段：

```
 * It is not necessary to specify {@code layout_width/height} if you specify {@code
 * layout_widthPercent.} However, if you want the view to be able to take up more space than what
 * percentage value permits, you can add {@code layout_width/height="wrap_content"}. In that case
 * if the percentage size is too small for the View's content, it will be resized using
 * {@code wrap_content} rule.
 我理解的是，在指定了 layout_widthPercent 后，并不要求继续指定 layout_width/height 。但是，如果希望在通过百分比指定大小后，仍可以占用更多的空间，则可以设置 layout_width/height 为 wrap_content。这种情况下，如果百分比大小不足以容纳 View 的内容，则会使用 wrap_content 来调整大小。
```

​	但是，我在试验时发现 wrap_content 并没有生效，在网上搜索也没找到答案，一般例子在使用时都是一个宽百分比+一个高 wrap_content，如 `layout_widthPercent = 50%` + `layout_height = wrap_content`。

​	使用的布局如下

```xml
<?xml version="1.0" encoding="utf-8"?>
<android.support.percent.PercentRelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <TextView
        android:layout_width="wrap_content"
        android:lines="1"
        android:text="w:50%, h:20%  wrap_content"
        app:layout_widthPercent="50%"
        app:layout_heightPercent="20%"
        android:textSize="24sp"
        android:background="#888"/>

</android.support.percent.PercentRelativeLayout>
```

​	实际结果

<img src="https://ws4.sinaimg.cn/large/006tKfTcgy1finw3ggfo7j30f20q8gm3.jpg" style="zoom:50%">



==不知道这是不是个 bug，可能答案只能在源码中找，暂时先记录在此==



