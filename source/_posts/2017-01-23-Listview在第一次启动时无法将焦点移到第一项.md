---
title: ListView 在第一次启动时无法将焦点移到第一项
tags:
  - android
date: 2017-01-23 15:37:22
categories: 笔记
---

==在设备第一次启动便打开Activity时仍存在无焦点问题，如果要实现高亮，最好用setItemChecked，而不是根据focused状态==

**条件**

Android5.1.1，设备无触摸

**问题描述**

设备第一次启动，通过语音启动Activity，界面中有一个ListView和标题，ListView设置了listSelector，但第一项无法显示选中背景，猜测是整个窗口都没有得到焦点，但打印getWindow().getCurrentFocus()显示焦点在ListView上

**解决**

[setSelection not changing ListView position](http://stackoverflow.com/questions/7018921/setselection-not-changing-listview-position)

[View的requestFocus()和requestFocusFromTouch()方法的区别](http://www.eoeandroid.com/blog-115216-25315.html?_dsign=2ab88c28)

```java
listview.postDelayed(new Runnable() {
			@Override
			public void run() {
				mSettingsList.requestFocusFromTouch();
				mSettingsList.setSelection(0);
			}
		}, 200);
//如果还出现概率失效，则可尝试稍微延长一下时间。不知道原理，真蛋疼。。。
```



> requestFocusFromTouch是requestFocus的变体，可允许不可聚焦的view在touch mode下请求焦点(被触摸时)。

requestFocus()在两种情况下不能获得焦点：

1. 对应的View不支持Focus
2. 对应的View支持Focus，但是不支持在Touch模式下的Focus。




如果仍存在焦点没有得到的问题，则可以尝试在onStart() 中增加一次requestFocus()

```java
@Override
	protected void onStart() {
		super.onStart();
		mSettingsList.requestFocus();
	}
```