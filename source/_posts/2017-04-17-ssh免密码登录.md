---
title: SSH - 免密码登录
tags:
  - ssh
date: 2017-04-17 15:37:22
categories: 笔记
---

[Generating Your SSH Public Key](https://git-scm.com/book/en/v2/Git-on-the-Server-Generating-Your-SSH-Public-Key)

[SSH login without password](http://www.linuxproblem.org/art_9.html)

通过使用 SSH 密钥，可以使我们在登录 Linux 时不需要输入密码。

### 生成密钥

+ 检查 key 是否已存在

```shell
$ cd ~/.ssh
$ ls
authorized_keys2  id_dsa       known_hosts
config            id_dsa.pub
```

可以看到目录下有一些`id_dsa` 或 `id_rsa`文件，对应的还有一个带有`.pub` 扩展名的文件。其中，`.pub`是我们的公钥，其它文件是私钥。

+ 如果没有上面的文件（或者`.ssh`目录），可以运行 **ssh-keygen** 程序来创建，-t 指定所用的算法，passphrase 留空即可

```shell
a@A:~> ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/home/a/.ssh/id_rsa): 
Created directory '/home/a/.ssh'.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/a/.ssh/id_rsa.
Your public key has been saved in /home/a/.ssh/id_rsa.pub.
The key fingerprint is:
3e:4f:05:79:3a:9f:96:7c:3b:ad:e9:58:37:bc:37:e4 a@A
```

### 将公钥拷贝到服务器

在服务器创建 ~/.ssh 文件夹

```Shell
a@A:~> ssh b@B mkdir -p .ssh
b@B's password: 
```

将公钥的内容拼接到 b@B:.ssh/authorized_keys

```shell
a@A:~> cat .ssh/id_rsa.pub | ssh b@B 'cat >> .ssh/authorized_keys'
b@B's password: 
```

直接登录

```shell
a@A:~> ssh b@B
```