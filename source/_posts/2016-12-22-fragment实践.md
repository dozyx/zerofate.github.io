---
title: Fragment - 实践
tags:
  - android
  - fragment
date: 2016-12-22 15:37:22
categories: 笔记
---



## 实例化

参考

[Best practice for instantiating a new Android Fragment](http://stackoverflow.com/questions/9245408/best-practice-for-instantiating-a-new-android-fragment)

​	实例化Fragment时一般使用静态newInstance(int arg)方法，此方法需要我们在编写Fragment类时主动添加，如

```java
//传入一个整型参数
public static MyFragment newInstance(int someInt) {
    MyFragment myFragment = new MyFragment();

    Bundle args = new Bundle();
    args.putInt("someInt", someInt);
    myFragment.setArguments(args);

    return myFragment;
}
```

​	使用newInstance的原因在于，如果Android系统在重建fragment时会自动调用无参的构造函数，这样会导致信息丢失。而使用newInstance可以通过setArguments来传递信息，然后在fragment的onCreate中通过getArguments来获得。并且通过设置带参数的构造函数，可以确保使用者正确地实例化。



### 为什么Fragment需要public的空构造方法

[Do fragments really need an empty constructor?](http://stackoverflow.com/questions/10450348/do-fragments-really-need-an-empty-constructor)

[Android Fragment$InstantiationException](http://haoxiqiang.github.io/blog/20150107-Android-Fragment$InstantiationException.html)

​	Fragment在某些情况下会自动重建，重建过程中将调用Fragment的instantiate(..)进行构造，instantiate(..)中又调用了newInstance方法，此方法在实例化时会检查accessor是否为public，无法访问则抛出异常。[文档](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#newInstance())

​	所以，使用参数实例化一个Fragment最好的方法是通过newInstance的工厂方法，而不是重载其构造方法。



### instantiate方法

​	在Fragment中还存在了一个instantiate()方法，该方法同样可以构造一个Fragment实例。在Fragment销毁重建时会调用此方法来进行重建。==目前对此方法还不是很了解==



## 在fragment的xml布局中使用android:onClick

android:onClick属性无法触发fragment中的onClick方法，需要通过Activity间接调用。











