---
title: 什么是注入 Inject
tags:
  - 注入
date: 2017-08-07 15:37:22
categories: 笔记
---

[Inject](http://docs.oracle.com/javaee/7/api/javax/inject/Inject.html)

```java
@Target({ METHOD, CONSTRUCTOR, FIELD })
@Retention(RUNTIME)
@Documented
public @interface Inject {}
```

​	**标识可注入（injectable）的构造函数、方法和字段**。 构造函数将是第一个被注入的，然后是字段，最后是方法，超类中的字段和方法的注入发生在子类之前。同一个类中的字段之间和方法之间的注入顺序没有指定。

> 个人理解：这里的注入应该理解为一个自动化过程，通常用于依赖注入框架，如 Spring、Dagger 2 等，@Inject 用来确定自动化过程中使用的成员。可注入构造函数表示某个类通过注入创建新实例时调用的构造函数。可注入字段表示在注入时为该字段自动创建一个实例，通常要求字段对应的类有可注入构造函数，否则将无法为该字段创建实例。

​	可注入的构造函数用 @Inject 注解，并接受 0 或多个 dependency 作为参数。**每个类中，@Inject 只能用于最多一个构造函数。**

​	当没有其他构造函数存在时，@Inject 对于 public 的无参构造函数是可选的，这使得 injector 可以调用默认构造函数。

​	可注入字段：

+ 使用 @Inject 注解
+ 不是 final 的
+ 可能有其他有效名称（这点不是很理解）



​	可注入方法：

+ 使用 @Inject 方法
+ 不是 abstract 的
+ 不能声明它们自己的类型参数
+ 可能有返回结果
+ 可能有其他有效名称
+ 接受 0 或多个 dependency 作为参数



​	injector 忽略注入方法的结果，但允许非 void 的返回类型以支持在其他 context 中使用该方法（如 builder 风格的链式方法）



例子：

```java
   public class Car {
     // Injectable constructor
     @Inject public Car(Engine engine) { ... }

     // Injectable field
     @Inject private Provider<Seat> seatProvider;

     // Injectable package-private method
     @Inject void install(Windshield windshield, Trunk trunk) { ... }
   }
```



### 限定符 qualifier

​	qualifier 可能用来注解可注入的字段或者参数，它们结合在一起来标识要注入的实现。Qualifier 是可选的，当在 injector 无关的类中与 @Inject 一起使用时，最多只能有一个 qualifier 用来注解单个字段或参数。下面例子中 qualifier 为粗体：

```java
   public class Car {
     @Inject private @Leather Provider<Seat> seatProvider;

     @Inject void install(@Tinted Windshield windshield,
         @Big Trunk trunk) { ... }
   }	
```



